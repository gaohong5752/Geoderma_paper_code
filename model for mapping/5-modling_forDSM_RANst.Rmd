---
title: "modelin_forDSM_RANst"
author: "gaohong"
date: "2019年7月13日"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


#设置工作路径，加载包
```{r}

library(rgdal)
library(raster)
library(randomForest)

```

#构建环境因子图层
```{r}
setwd("E:/soilPaper/modling/EnFactor")

files<-c("DEM.tif","Slope.tif","PlanC.tif","ProfileC.tif","TWI.tif","Bedrock.tif","LSF.tif","VD.tif","RSP.tif")

covStack <- raster(files[1])
for (i in 2:length(files)) {
  covStack <- stack(covStack, files[i])
}

#设置读取样点数据路径
point_shp_folder="E:/soilPaper/modling/allTrainingSamples_shp/"

#设置最终结果tif的保存路径
result_tif_folder="E:/soilPaper/modling/result_mapTif/"

##设置随机数种子
set.seed(2019)

soil_type<-c(1,3,7,20,21,23,30,31,501,502,503)  # 41样本数量太少，删掉。
sampleNum_dict<-list()

```

#DEM -ok
##ns3
RANst  DEM ns3 15
```{r}
mn="All_pRANst_DEM_NS3_pen15" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  DEM ns3 30
```{r}
mn="All_pRANst_DEM_NS3_pen30" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  DEM ns3 45
```{r}
mn="All_pRANst_DEM_NS3_pen45" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
##ns5
RANst  DEM ns5 15
```{r}
mn="All_pRANst_DEM_NS5_pen15" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  DEM ns5 30
```{r}
mn="All_pRANst_DEM_NS5_pen30" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  DEM ns5 45
```{r}
mn="All_pRANst_DEM_NS5_pen45" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
##ns7
RANst  DEM ns7 15
```{r}
mn="All_pRANst_DEM_NS7_pen15" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  DEM ns7 30
```{r}
mn="All_pRANst_DEM_NS7_pen30" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  DEM ns7 45
```{r}
mn="All_pRANst_DEM_NS7_pen45" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```

#Slope -ok
##ns3
RANst  Slope ns3 15
```{r}
mn="All_pRANst_Slope_NS3_pen15" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  Slope ns3 30
```{r}
mn="All_pRANst_Slope_NS3_pen30" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  Slope ns3 45
```{r}
mn="All_pRANst_Slope_NS3_pen45" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
##ns5
RANst  Slope ns5 15
```{r}
mn="All_pRANst_Slope_NS5_pen15" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  Slope ns5 30
```{r}
mn="All_pRANst_Slope_NS5_pen30" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  Slope ns5 45
```{r}
mn="All_pRANst_Slope_NS5_pen45" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
##ns7
RANst  Slope ns7 15
```{r}
mn="All_pRANst_Slope_NS7_pen15" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  Slope ns7 30
```{r}
mn="All_pRANst_Slope_NS7_pen30" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  Slope ns7 45
```{r}
mn="All_pRANst_Slope_NS7_pen45" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```


#PlanC -ok
##ns3
RANst  PlanC ns3 15
```{r}
mn="All_pRANst_PlanC_NS3_pen15" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  PlanC ns3 30
```{r}
mn="All_pRANst_PlanC_NS3_pen30" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  PlanC ns3 45
```{r}
mn="All_pRANst_PlanC_NS3_pen45" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
##ns5
RANst  PlanC ns5 15
```{r}
mn="All_pRANst_PlanC_NS5_pen15" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  PlanC ns5 30
```{r}
mn="All_pRANst_PlanC_NS5_pen30" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  PlanC ns5 45
```{r}
mn="All_pRANst_PlanC_NS5_pen45" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
##ns7
RANst  PlanC ns7 15
```{r}
mn="All_pRANst_PlanC_NS7_pen15" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  PlanC ns7 30
```{r}
mn="All_pRANst_PlanC_NS7_pen30" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  PlanC ns7 45
```{r}
mn="All_pRANst_PlanC_NS7_pen45" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```


#ProfileC -ok
##ns3
RANst  ProfileC ns3 15
```{r}
mn="All_pRANst_ProfileC_NS3_pen15" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  ProfileC ns3 30
```{r}
mn="All_pRANst_ProfileC_NS3_pen30" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  ProfileC ns3 45
```{r}
mn="All_pRANst_ProfileC_NS3_pen45" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
##ns5
RANst  ProfileC ns5 15
```{r}
mn="All_pRANst_ProfileC_NS5_pen15" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  ProfileC ns5 30
```{r}
mn="All_pRANst_ProfileC_NS5_pen30" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  ProfileC ns5 45
```{r}
mn="All_pRANst_ProfileC_NS5_pen45" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
##ns7
RANst  ProfileC ns7 15
```{r}
mn="All_pRANst_ProfileC_NS7_pen15" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  ProfileC ns7 30
```{r}
mn="All_pRANst_ProfileC_NS7_pen30" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  ProfileC ns7 45
```{r}
mn="All_pRANst_ProfileC_NS7_pen45" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```


#TWI -ok
##ns3
RANst  TWI ns3 15
```{r}
mn="All_pRANst_TWI_NS3_pen15" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  TWI ns3 30
```{r}
mn="All_pRANst_TWI_NS3_pen30" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  TWI ns3 45
```{r}
mn="All_pRANst_TWI_NS3_pen45" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
##ns5
RANst  TWI ns5 15
```{r}
mn="All_pRANst_TWI_NS5_pen15" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  TWI ns5 30
```{r}
mn="All_pRANst_TWI_NS5_pen30" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  TWI ns5 45
```{r}
mn="All_pRANst_TWI_NS5_pen45" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
##ns7
RANst  TWI ns7 15
```{r}
mn="All_pRANst_TWI_NS7_pen15" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  TWI ns7 30
```{r}
mn="All_pRANst_TWI_NS7_pen30" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  TWI ns7 45
```{r}
mn="All_pRANst_TWI_NS7_pen45" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```


#LSF -ok
##ns3
RANst  LSF ns3 15
```{r}
mn="All_pRANst_LSF_NS3_pen15" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  LSF ns3 30
```{r}
mn="All_pRANst_LSF_NS3_pen30" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  LSF ns3 45
```{r}
mn="All_pRANst_LSF_NS3_pen45" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
##ns5
RANst  LSF ns5 15
```{r}
mn="All_pRANst_LSF_NS5_pen15" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  LSF ns5 30
```{r}
mn="All_pRANst_LSF_NS5_pen30" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  LSF ns5 45
```{r}
mn="All_pRANst_LSF_NS5_pen45" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
##ns7
RANst  LSF ns7 15
```{r}
mn="All_pRANst_LSF_NS7_pen15" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  LSF ns7 30
```{r}
mn="All_pRANst_LSF_NS7_pen30" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  LSF ns7 45
```{r}
mn="All_pRANst_LSF_NS7_pen45" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```


#VD -ok
##ns3
RANst  VD ns3 15
```{r}
mn="All_pRANst_VD_NS3_pen15" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  VD ns3 30
```{r}
mn="All_pRANst_VD_NS3_pen30" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  VD ns3 45
```{r}
mn="All_pRANst_VD_NS3_pen45" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
##ns5
RANst  VD ns5 15
```{r}
mn="All_pRANst_VD_NS5_pen15" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  VD ns5 30
```{r}
mn="All_pRANst_VD_NS5_pen30" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  VD ns5 45
```{r}
mn="All_pRANst_VD_NS5_pen45" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
##ns7
RANst  VD ns7 15
```{r}
mn="All_pRANst_VD_NS7_pen15" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  VD ns7 30
```{r}
mn="All_pRANst_VD_NS7_pen30" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  VD ns7 45
```{r}
mn="All_pRANst_VD_NS7_pen45" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```


#RSP -ok
##ns3
RANst  RSP ns3 15
```{r}
mn="All_pRANst_RSP_NS3_pen15" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  RSP ns3 30
```{r}
mn="All_pRANst_RSP_NS3_pen30" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  RSP ns3 45
```{r}
mn="All_pRANst_RSP_NS3_pen45" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
##ns5
RANst  RSP ns5 15
```{r}
mn="All_pRANst_RSP_NS5_pen15" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  RSP ns5 30
```{r}
mn="All_pRANst_RSP_NS5_pen30" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  RSP ns5 45
```{r}
mn="All_pRANst_RSP_NS5_pen45" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
##ns7
RANst  RSP ns7 15
```{r}
mn="All_pRANst_RSP_NS7_pen15" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  RSP ns7 30
```{r}
mn="All_pRANst_RSP_NS7_pen30" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```
RANst  RSP ns7 45
```{r}
mn="All_pRANst_RSP_NS7_pen45" 

shpPoint<-readOGR(paste(point_shp_folder,mn,".shp",sep = "")) ###
sampData <- extract(covStack, shpPoint, sp = TRUE,method = "simple") 

sampData<-sampData@data

sampData<-sampData[sampData$soilID %in% soil_type,]

sampData<-na.omit(sampData)

print(dim(sampData))

sampleNum_dict[mn]<-nrow(sampData)

sampData$Bedrock<- droplevels(as.factor(sampData$Bedrock))
sampData$soilID<- droplevels(as.factor(sampData$soilID))

RF_model<-randomForest(soilID ~.,data = sampData, 
                       importance = TRUE, proximity = FALSE,
                       ntree=1000,type="classification")

varImpPlot(RF_model)
print(RF_model)

map_RF <- predict(covStack, RF_model, paste(result_tif_folder,mn,".tif",sep=""),
                  format = "GTiff", datatype = "FLT4S", overwrite = TRUE)

rm("mn","shpPoint","sampData","RF_model","map_RF")

```

##精度计算
```{r}
#设置最终结果tif的保存路径
result_tif_folder="E:/soilPaper/modling/result_mapTif/"

result_map_name<-c("All_pRANst_DEM_NS3_pen15","All_pRANst_DEM_NS5_pen15","All_pRANst_DEM_NS7_pen15",
                   "All_pRANst_DEM_NS3_pen30","All_pRANst_DEM_NS5_pen30","All_pRANst_DEM_NS7_pen30",
                   "All_pRANst_DEM_NS3_pen45","All_pRANst_DEM_NS5_pen45","All_pRANst_DEM_NS7_pen45",
                   "All_pRANst_Slope_NS3_pen15","All_pRANst_Slope_NS5_pen15","All_pRANst_Slope_NS7_pen15",
                   "All_pRANst_Slope_NS3_pen30","All_pRANst_Slope_NS5_pen30","All_pRANst_Slope_NS7_pen30",
                   "All_pRANst_Slope_NS3_pen45","All_pRANst_Slope_NS5_pen45","All_pRANst_Slope_NS7_pen45",
                   "All_pRANst_PlanC_NS3_pen15","All_pRANst_PlanC_NS5_pen15","All_pRANst_PlanC_NS7_pen15",
                   "All_pRANst_PlanC_NS3_pen30","All_pRANst_PlanC_NS5_pen30","All_pRANst_PlanC_NS7_pen30",
                   "All_pRANst_PlanC_NS3_pen45","All_pRANst_PlanC_NS5_pen45","All_pRANst_PlanC_NS7_pen45",
                   "All_pRANst_ProfileC_NS3_pen15","All_pRANst_ProfileC_NS5_pen15","All_pRANst_ProfileC_NS7_pen15",
                   "All_pRANst_ProfileC_NS3_pen30","All_pRANst_ProfileC_NS5_pen30","All_pRANst_ProfileC_NS7_pen30",
                   "All_pRANst_ProfileC_NS3_pen45","All_pRANst_ProfileC_NS5_pen45","All_pRANst_ProfileC_NS7_pen45",
                   "All_pRANst_TWI_NS3_pen15","All_pRANst_TWI_NS5_pen15","All_pRANst_TWI_NS7_pen15",
                   "All_pRANst_TWI_NS3_pen30","All_pRANst_TWI_NS5_pen30","All_pRANst_TWI_NS7_pen30",
                   "All_pRANst_TWI_NS3_pen45","All_pRANst_TWI_NS5_pen45","All_pRANst_TWI_NS7_pen45",
                   "All_pRANst_LSF_NS3_pen15","All_pRANst_LSF_NS5_pen15","All_pRANst_LSF_NS7_pen15",
                   "All_pRANst_LSF_NS3_pen30","All_pRANst_LSF_NS5_pen30","All_pRANst_LSF_NS7_pen30",
                   "All_pRANst_LSF_NS3_pen45","All_pRANst_LSF_NS5_pen45","All_pRANst_LSF_NS7_pen45",
                   "All_pRANst_VD_NS3_pen15","All_pRANst_VD_NS5_pen15","All_pRANst_VD_NS7_pen15",
                   "All_pRANst_VD_NS3_pen30","All_pRANst_VD_NS5_pen30","All_pRANst_VD_NS7_pen30",
                   "All_pRANst_VD_NS3_pen45","All_pRANst_VD_NS5_pen45","All_pRANst_VD_NS7_pen45",
                   "All_pRANst_RSP_NS3_pen15","All_pRANst_RSP_NS5_pen15","All_pRANst_RSP_NS7_pen15",
                   "All_pRANst_RSP_NS3_pen30","All_pRANst_RSP_NS5_pen30","All_pRANst_RSP_NS7_pen30",
                   "All_pRANst_RSP_NS3_pen45","All_pRANst_RSP_NS5_pen45","All_pRANst_RSP_NS7_pen45")

resultCovStack<-raster(paste(result_tif_folder,result_map_name[1],".tif",sep = ""))
for (i in 2:length(result_map_name)) {
  resultCovStack <- stack(resultCovStack, raster(paste(result_tif_folder,result_map_name[i],".tif",sep = "")))
}

validationPoint<-readOGR(paste(result_tif_folder,"validationPoint.shp",sep = "")) ###


vp_data <- extract(resultCovStack, validationPoint, sp = TRUE,method = "simple") 
vp_data<-na.omit(vp_data@data)


vp_data<-vp_data[vp_data$trueType %in% soil_type,]

print(nrow(vp_data))

precision_df<-data.frame("method"=rep(NA,length(result_map_name)),
                         "factor"=rep(NA,length(result_map_name)),
                         "NS"=rep(NA,length(result_map_name)),
                         "percent"=rep(NA,length(result_map_name)),
                         "precisionValue"=rep(NA,length(result_map_name)),
                         "sampleNum"=rep(NA,length(result_map_name)))

for (i in 1:length(result_map_name)){
  fna<-result_map_name[i]
  ns_split<-unlist(strsplit(fna,"_"))
  if (length(ns_split)==5){
    precision_df[i,]$method<-ns_split[2]
    precision_df[i,]$factor<-ns_split[3]
    precision_df[i,]$NS<-ns_split[4]
    precision_df[i,]$percent<-ns_split[5]
    precision_df[i,]$precisionValue<-round( sum(vp_data$trueType==vp_data[fna])/nrow(vp_data),4)
    precision_df[i,]$sampleNum<-as.vector(unlist(sampleNum_dict[fna]))
  }

}

precision_oldSoilMap<-round( sum(vp_data$trueType==vp_data$oldSoilMap)/nrow(vp_data),4)
print(precision_oldSoilMap)

print(precision_df)

write.csv(precision_df,"结果精度_随机土壤类型_origin.csv",row.names = F,fileEncoding="utf-8")



pdf_ran<-subset(precision_df,method=="pRANst")

pdf_ran_mean<-aggregate(pdf_ran[,c("precisionValue","sampleNum")],by=list(method=pdf_ran$method,NS=pdf_ran$NS,percent=pdf_ran$percent),FUN=mean)
pdf_ran_mean$factor<-"Random"

precision_df_final<-pdf_ran_mean
print(precision_df_final)

write.csv(precision_df_final,"结果精度_随机土壤类型_final.csv",row.names = F,fileEncoding="utf-8")
```